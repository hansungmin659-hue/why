import React, { useState, useEffect, useRef } from 'react';
import { Play, Pause, ChevronDown, Mail, Instagram, Linkedin, Twitter, ExternalLink, X, Monitor, PenTool, Box, Layers, Camera, Sparkles } from 'lucide-react';
import { motion, AnimatePresence, useScroll, useTransform } from 'framer-motion';

// --- Mock Data (포트폴리오 데이터) ---
const projects = [
  {
    id: 1,
    title: "Cyberpunk Character Walk",
    category: "Character Animation",
    image: "https://images.unsplash.com/photo-1615840287214-7ff58ee04896?q=80&w=800&auto=format&fit=crop",
    video: "#", // 실제 영상 링크로 대체 가능
    description: "미래 도시 배경의 사이버펑크 캐릭터 보행 사이클 연구입니다. 무게감과 기계적인 관절 움직임에 중점을 두었습니다.",
    tools: ["Maya", "Arnold"]
  },
  {
    id: 2,
    title: "Forest Spirit - Lighting",
    category: "Lighting & Shading",
    image: "https://images.unsplash.com/photo-1518546305927-5a5a16c9d3e4?q=80&w=800&auto=format&fit=crop",
    description: "신비로운 숲의 분위기를 연출하기 위한 라이팅 및 텍스처링 작업입니다. Sub-surface scattering을 활용했습니다.",
    tools: ["Blender", "Cycles"]
  },
  {
    id: 3,
    title: "Combat Combo Sequence",
    category: "Game Animation",
    image: "https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=800&auto=format&fit=crop",
    description: "액션 RPG 게임을 위한 3연타 공격 모션입니다. 타격감과 타이밍, 포즈의 실루엣을 강조했습니다.",
    tools: ["3ds Max", "Unreal Engine 5"]
  },
  {
    id: 4,
    title: "Product Reveal: Neo-Watch",
    category: "Motion Graphics",
    image: "https://images.unsplash.com/photo-1523170335258-f5ed11844a49?q=80&w=800&auto=format&fit=crop",
    description: "스마트 워치 제품 홍보 영상입니다. 매끄러운 카메라 워크와 제품 분해 조립 애니메이션을 포함합니다.",
    tools: ["Cinema 4D", "Redshift"]
  },
  {
    id: 5,
    title: "Facial Rigging Test",
    category: "Rigging",
    image: "https://images.unsplash.com/photo-1509347528160-9a9e33742cd4?q=80&w=800&auto=format&fit=crop",
    description: "미세한 표정 변화를 위한 페이셜 리깅 테스트입니다. 52개의 Blendshape을 기반으로 제작되었습니다.",
    tools: ["Maya", "Python"]
  },
  {
    id: 6,
    title: "Sci-Fi Environment",
    category: "Modeling",
    image: "https://images.unsplash.com/photo-1478760329108-5c3ed9d495a0?q=80&w=800&auto=format&fit=crop",
    description: "우주 정거장 내부 모델링입니다. 하드 서페이스 모델링 기법과 모듈형 에셋 제작 방식을 사용했습니다.",
    tools: ["Blender", "Substance Painter"]
  }
];

const skills = [
  { name: "Autodesk Maya", level: 95, icon: <Box /> },
  { name: "Blender", level: 90, icon: <Box /> },
  { name: "Unreal Engine 5", level: 85, icon: <Monitor /> },
  { name: "ZBrush", level: 80, icon: <PenTool /> },
  { name: "Substance Painter", level: 88, icon: <Layers /> },
  { name: "After Effects", level: 75, icon: <Camera /> },
];

// --- Components ---

const Navbar = () => {
  const [isScrolled, setIsScrolled] = useState(false);

  useEffect(() => {
    const handleScroll = () => setIsScrolled(window.scrollY > 50);
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  return (
    <nav className={`fixed top-0 w-full z-50 transition-all duration-300 ${isScrolled ? 'bg-black/80 backdrop-blur-md py-4 border-b border-white/10' : 'bg-transparent py-6'}`}>
      <div className="container mx-auto px-6 flex justify-between items-center">
        <div className="text-2xl font-bold tracking-tighter text-white">
          KIM<span className="text-cyan-400">.Motion</span>
        </div>
        <div className="hidden md:flex space-x-8 text-sm font-medium text-gray-300">
          <a href="#home" className="hover:text-cyan-400 transition-colors">HOME</a>
          <a href="#showreel" className="hover:text-cyan-400 transition-colors">SHOWREEL</a>
          <a href="#work" className="hover:text-cyan-400 transition-colors">WORK</a>
          <a href="#about" className="hover:text-cyan-400 transition-colors">ABOUT</a>
          <a href="#contact" className="hover:text-cyan-400 transition-colors">CONTACT</a>
        </div>
        <a href="#contact" className="px-4 py-2 text-sm font-bold bg-white text-black hover:bg-cyan-400 transition-colors rounded-full hidden md:block">
          Let's Talk
        </a>
      </div>
    </nav>
  );
};

const Hero = () => {
  const { scrollY } = useScroll();
  const y1 = useTransform(scrollY, [0, 500], [0, 200]);
  const y2 = useTransform(scrollY, [0, 500], [0, -150]);

  return (
    <section id="home" className="relative h-screen flex items-center justify-center overflow-hidden bg-black">
      {/* Abstract Background Elements */}
      <motion.div style={{ y: y1 }} className="absolute top-20 left-20 w-72 h-72 bg-cyan-500/20 rounded-full blur-3xl" />
      <motion.div style={{ y: y2 }} className="absolute bottom-20 right-20 w-96 h-96 bg-purple-600/20 rounded-full blur-3xl" />
      
      {/* Grid Overlay */}
      <div className="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.03)_1px,transparent_1px)] bg-[size:40px_40px] [mask-image:radial-gradient(ellipse_at_center,black,transparent_80%)] pointer-events-none"></div>

      <div className="relative z-10 text-center px-4">
        <motion.div
          initial={{ opacity: 0, y: 30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8 }}
        >
          <h2 className="text-cyan-400 font-medium tracking-widest mb-4 text-lg md:text-xl">3D ANIMATOR & VISUAL ARTIST</h2>
          <h1 className="text-6xl md:text-8xl font-extrabold text-white tracking-tighter mb-6 leading-tight">
            BRINGING<br />
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-white via-gray-200 to-gray-500">IMAGINATION</span><br />
            TO LIFE
          </h1>
          <p className="text-gray-400 max-w-xl mx-auto text-lg mb-10">
            캐릭터 애니메이션부터 하드 서페이스 모델링까지.<br/> 
            이야기가 살아 숨쉬는 움직임을 만듭니다.
          </p>
        </motion.div>

        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.5, duration: 1 }}
          className="flex justify-center gap-4"
        >
          <a href="#showreel" className="px-8 py-4 bg-cyan-500 hover:bg-cyan-400 text-black font-bold rounded-full transition-all flex items-center gap-2">
            <Play size={18} fill="currentColor" /> Watch Showreel
          </a>
          <a href="#work" className="px-8 py-4 border border-white/20 hover:border-white text-white font-bold rounded-full transition-all">
            View Portfolio
          </a>
        </motion.div>
      </div>

      <motion.div 
        animate={{ y: [0, 10, 0] }} 
        transition={{ repeat: Infinity, duration: 2 }}
        className="absolute bottom-10 left-1/2 -translate-x-1/2 text-white/50"
      >
        <ChevronDown size={32} />
      </motion.div>
    </section>
  );
};

const Showreel = () => {
  const [isPlaying, setIsPlaying] = useState(false);

  return (
    <section id="showreel" className="py-24 bg-zinc-950 relative">
      <div className="container mx-auto px-6">
        <div className="flex flex-col items-center mb-12">
          <h2 className="text-4xl md:text-5xl font-bold text-white mb-4">DEMO REEL 2025</h2>
          <div className="w-20 h-1 bg-cyan-500 rounded-full"></div>
        </div>

        <div className="relative aspect-video w-full max-w-5xl mx-auto bg-zinc-900 rounded-xl overflow-hidden border border-zinc-800 shadow-2xl shadow-cyan-900/20 group">
          {/* Placeholder for Video */}
          {!isPlaying ? (
            <div className="absolute inset-0 flex items-center justify-center bg-cover bg-center" style={{ backgroundImage: 'url("https://images.unsplash.com/photo-1635322966219-b75ed372eb01?q=80&w=1920&auto=format&fit=crop")' }}>
              <div className="absolute inset-0 bg-black/60 group-hover:bg-black/40 transition-all duration-300"></div>
              <button 
                onClick={() => setIsPlaying(true)}
                className="relative z-10 w-24 h-24 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/20 hover:scale-110 hover:bg-cyan-500 hover:border-cyan-500 transition-all duration-300 group-hover:shadow-[0_0_30px_rgba(6,182,212,0.5)]"
              >
                <Play size={32} fill="white" className="text-white ml-1" />
              </button>
              <div className="absolute bottom-8 left-8 text-left">
                <p className="text-cyan-400 font-bold tracking-wider text-sm mb-1">LATEST WORK</p>
                <h3 className="text-2xl font-bold text-white">Generalist Showreel</h3>
              </div>
            </div>
          ) : (
            <div className="w-full h-full bg-black flex items-center justify-center text-white relative">
              <p>비디오 플레이어가 여기에 로드됩니다.</p>
              <button 
                onClick={() => setIsPlaying(false)}
                className="absolute top-4 right-4 p-2 bg-black/50 rounded-full hover:bg-red-500 transition-colors"
              >
                <X size={24} />
              </button>
            </div>
          )}
        </div>
      </div>
    </section>
  );
};

const ProjectCard = ({ project, onClick }) => {
  return (
    <motion.div 
      layoutId={`project-${project.id}`}
      onClick={() => onClick(project)}
      initial={{ opacity: 0, y: 20 }}
      whileInView={{ opacity: 1, y: 0 }}
      viewport={{ once: true }}
      whileHover={{ y: -10 }}
      className="group relative cursor-pointer rounded-xl overflow-hidden bg-zinc-900 border border-zinc-800"
    >
      <div className="aspect-[4/3] overflow-hidden">
        <img 
          src={project.image} 
          alt={project.title} 
          className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
        />
      </div>
      <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
        <p className="text-cyan-400 text-xs font-bold tracking-wider mb-1">{project.category.toUpperCase()}</p>
        <h3 className="text-xl font-bold text-white">{project.title}</h3>
        <div className="mt-3 flex items-center gap-2 text-xs text-gray-300">
          <span>View Details</span> <ExternalLink size={12} />
        </div>
      </div>
    </motion.div>
  );
};

const ProjectModal = ({ project, onClose }) => {
  if (!project) return null;

  return (
    <AnimatePresence>
      <motion.div 
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        exit={{ opacity: 0 }}
        className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm"
        onClick={onClose}
      >
        <motion.div 
          layoutId={`project-${project.id}`}
          className="bg-zinc-900 w-full max-w-4xl rounded-2xl overflow-hidden shadow-2xl border border-zinc-800"
          onClick={e => e.stopPropagation()}
        >
          <div className="relative aspect-video bg-black">
             <img src={project.image} alt={project.title} className="w-full h-full object-cover opacity-80" />
             <button onClick={onClose} className="absolute top-4 right-4 p-2 bg-black/50 rounded-full hover:bg-white hover:text-black transition-all">
               <X size={24} />
             </button>
          </div>
          <div className="p-8 md:flex gap-8">
            <div className="md:w-2/3">
              <div className="flex items-center gap-3 mb-2">
                 <span className="px-3 py-1 bg-cyan-500/10 text-cyan-400 rounded-full text-xs font-bold border border-cyan-500/20">
                   {project.category}
                 </span>
              </div>
              <h2 className="text-3xl font-bold text-white mb-4">{project.title}</h2>
              <p className="text-gray-400 leading-relaxed mb-6">{project.description}</p>
            </div>
            <div className="md:w-1/3 space-y-6 border-l border-zinc-800 md:pl-8 mt-6 md:mt-0">
              <div>
                <h4 className="text-white font-bold mb-3 flex items-center gap-2"><Sparkles size={16} className="text-cyan-400"/> Tools Used</h4>
                <div className="flex flex-wrap gap-2">
                  {project.tools.map((tool, idx) => (
                    <span key={idx} className="px-3 py-1 bg-zinc-800 text-gray-300 rounded text-sm border border-zinc-700">
                      {tool}
                    </span>
                  ))}
                </div>
              </div>
              <button className="w-full py-3 bg-white text-black font-bold rounded hover:bg-cyan-400 transition-colors">
                View Full Project
              </button>
            </div>
          </div>
        </motion.div>
      </motion.div>
    </AnimatePresence>
  );
};

const Work = () => {
  const [selectedProject, setSelectedProject] = useState(null);
  const [filter, setFilter] = useState('All');
  const categories = ['All', 'Character Animation', 'Game Animation', 'Modeling', 'Lighting & Shading'];

  const filteredProjects = filter === 'All' 
    ? projects 
    : projects.filter(p => p.category === filter);

  return (
    <section id="work" className="py-24 bg-black relative">
      <div className="container mx-auto px-6">
        <div className="flex flex-col md:flex-row md:items-end justify-between mb-12">
          <div>
            <h2 className="text-4xl md:text-5xl font-bold text-white mb-2">SELECTED WORKS</h2>
            <p className="text-gray-400">다양한 프로젝트를 통해 쌓아온 경험들입니다.</p>
          </div>
          
          <div className="flex flex-wrap gap-2 mt-6 md:mt-0">
            {categories.map(cat => (
              <button 
                key={cat}
                onClick={() => setFilter(cat)}
                className={`px-4 py-2 text-sm rounded-full transition-all ${
                  filter === cat 
                  ? 'bg-white text-black font-bold' 
                  : 'bg-zinc-900 text-gray-400 hover:bg-zinc-800'
                }`}
              >
                {cat}
              </button>
            ))}
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {filteredProjects.map(project => (
            <ProjectCard key={project.id} project={project} onClick={setSelectedProject} />
          ))}
        </div>
      </div>
      
      {selectedProject && (
        <ProjectModal project={selectedProject} onClose={() => setSelectedProject(null)} />
      )}
    </section>
  );
};

const About = () => {
  return (
    <section id="about" className="py-24 bg-zinc-950 border-y border-zinc-900">
      <div className="container mx-auto px-6">
        <div className="flex flex-col lg:flex-row gap-16 items-center">
          <div className="lg:w-1/2 relative">
            <div className="w-full aspect-[3/4] rounded-2xl overflow-hidden relative">
              <img 
                src="https://images.unsplash.com/photo-1507238691740-187a5b1d37b8?q=80&w=800&auto=format&fit=crop" 
                alt="Profile" 
                className="w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-500"
              />
              <div className="absolute inset-0 border-2 border-cyan-500/30 rounded-2xl transform translate-x-4 translate-y-4 -z-10"></div>
            </div>
          </div>
          
          <div className="lg:w-1/2">
            <h3 className="text-cyan-400 font-bold tracking-wider mb-2">ABOUT ME</h3>
            <h2 className="text-4xl font-bold text-white mb-6">디테일이 만드는 생명력,<br/>3D 애니메이터 김민수입니다.</h2>
            <p className="text-gray-400 leading-relaxed mb-6">
              저는 단순히 캐릭터를 움직이는 것을 넘어, 캐릭터에 감정과 성격을 부여하는 것에 열정을 가지고 있습니다.
              5년간의 실무 경험을 통해 게임 엔진 최적화부터 시네마틱 컷신 연출까지 다양한 파이프라인을 경험했습니다.
              항상 새로운 툴과 기술을 배우는 것을 즐기며, 팀원들과의 원활한 소통을 최우선으로 생각합니다.
            </p>
            
            <div className="space-y-6 mt-8">
              <h4 className="text-white font-bold text-lg">Technical Skills</h4>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                {skills.map((skill, idx) => (
                  <div key={idx} className="bg-zinc-900 p-4 rounded-lg border border-zinc-800 flex items-center gap-3 hover:border-cyan-500/50 transition-colors">
                    <div className="text-cyan-400">{skill.icon}</div>
                    <div className="flex-1">
                      <div className="flex justify-between mb-1">
                        <span className="text-sm font-medium text-white">{skill.name}</span>
                        <span className="text-xs text-gray-500">{skill.level}%</span>
                      </div>
                      <div className="w-full h-1 bg-zinc-800 rounded-full overflow-hidden">
                        <motion.div 
                          initial={{ width: 0 }}
                          whileInView={{ width: `${skill.level}%` }}
                          transition={{ duration: 1, delay: 0.2 }}
                          className="h-full bg-cyan-500"
                        />
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  );
};

const Contact = () => {
  return (
    <section id="contact" className="py-24 bg-black">
      <div className="container mx-auto px-6 max-w-4xl text-center">
        <h2 className="text-5xl font-bold text-white mb-8">Let's Create Together</h2>
        <p className="text-gray-400 mb-12 text-lg">
          새로운 프로젝트 제안이나 협업 문의는 언제나 환영입니다.<br/>
          함께 멋진 작품을 만들어보고 싶다면 연락주세요.
        </p>
        
        <div className="grid md:grid-cols-3 gap-6 mb-12">
          <a href="mailto:hello@example.com" className="flex flex-col items-center justify-center p-8 bg-zinc-900 rounded-2xl hover:bg-zinc-800 hover:-translate-y-2 transition-all border border-zinc-800 group">
            <div className="w-12 h-12 bg-cyan-500/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-cyan-500 group-hover:text-black transition-colors text-cyan-400">
              <Mail />
            </div>
            <h3 className="text-white font-bold mb-1">Email</h3>
            <p className="text-gray-500 text-sm">hello@kim-motion.com</p>
          </a>
          
          <a href="#" className="flex flex-col items-center justify-center p-8 bg-zinc-900 rounded-2xl hover:bg-zinc-800 hover:-translate-y-2 transition-all border border-zinc-800 group">
             <div className="w-12 h-12 bg-purple-500/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-purple-500 group-hover:text-black transition-colors text-purple-400">
              <Linkedin />
            </div>
            <h3 className="text-white font-bold mb-1">LinkedIn</h3>
            <p className="text-gray-500 text-sm">/in/kimminsu-anim</p>
          </a>

          <a href="#" className="flex flex-col items-center justify-center p-8 bg-zinc-900 rounded-2xl hover:bg-zinc-800 hover:-translate-y-2 transition-all border border-zinc-800 group">
             <div className="w-12 h-12 bg-pink-500/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-pink-500 group-hover:text-black transition-colors text-pink-400">
              <Instagram />
            </div>
            <h3 className="text-white font-bold mb-1">Instagram</h3>
            <p className="text-gray-500 text-sm">@kim_3dart</p>
          </a>
        </div>

        <form className="text-left bg-zinc-900 p-8 rounded-2xl border border-zinc-800">
          <div className="grid md:grid-cols-2 gap-6 mb-6">
            <div>
              <label className="block text-gray-400 text-sm mb-2">Name</label>
              <input type="text" className="w-full bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-cyan-500 transition-colors" placeholder="홍길동" />
            </div>
            <div>
              <label className="block text-gray-400 text-sm mb-2">Email</label>
              <input type="email" className="w-full bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-cyan-500 transition-colors" placeholder="hello@example.com" />
            </div>
          </div>
          <div className="mb-6">
            <label className="block text-gray-400 text-sm mb-2">Message</label>
            <textarea rows="4" className="w-full bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-cyan-500 transition-colors" placeholder="프로젝트에 대해 이야기해주세요..."></textarea>
          </div>
          <button className="w-full py-4 bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold rounded-lg hover:opacity-90 transition-opacity">
            Send Message
          </button>
        </form>
      </div>
    </section>
  );
};

const Footer = () => {
  return (
    <footer className="bg-black py-8 border-t border-zinc-900 text-center text-gray-600 text-sm">
      <p>&copy; 2025 Kim Min-Su. All Rights Reserved.</p>
      <p className="mt-2">Designed & Developed with React</p>
    </footer>
  );
};

const App = () => {
  return (
    <div className="bg-black min-h-screen text-white selection:bg-cyan-500 selection:text-black font-sans">
      <Navbar />
      <main>
        <Hero />
        <Showreel />
        <Work />
        <About />
        <Contact />
      </main>
      <Footer />
    </div>
  );
};

export default App;
